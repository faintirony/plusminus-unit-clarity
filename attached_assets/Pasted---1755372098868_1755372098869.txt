–î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ "–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞" –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ - —ç—Ç–æ –∫–ª—é—á–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–µ–ª–ª–µ—Ä–æ–≤ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏. –ë–µ–∑ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∞—Ä–∂—É –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ —è–≤–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã —Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è –∏ –¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

–ö–æ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
CSS (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è styles.css)
css

–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
/* –°–æ—Å—Ç–æ—è–Ω–∏–µ "–Ω–µ —É–∫–∞–∑–∞–Ω–æ" –¥–ª—è —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ */
.metric-value.not-specified {
    color: #718096;
    font-style: italic;
    font-weight: 500;
}

.metric-value.not-specified:hover {
    background: #fff5d6;
    border-color: #f59e0b;
}

/* –°—Ç–∞—Ç—É—Å "–£–∫–∞–∂–∏—Ç–µ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å" */
.profitability-badge.needs-cost {
    background: #fef3c7;
    color: #92400e;
    animation: subtle-pulse 2s ease-in-out infinite;
}

@keyframes subtle-pulse {
    0%, 100% { 
        background-color: #fef3c7; 
    }
    50% { 
        background-color: #fed7aa; 
    }
}

/* –ü—Ä–æ—á–µ—Ä–∫–∏ –¥–ª—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ */
.metric-value.undefined {
    color: #a0aec0;
    font-weight: 400;
    font-size: 16px;
}

/* –°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ */
.stat-needs-cost {
    color: #f59e0b;
    font-weight: 600;
}

/* –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è "–Ω–µ —É–∫–∞–∑–∞–Ω–æ" */
.metric-value.editing.not-specified {
    background: #fef3c7;
    border-color: #f59e0b;
    box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
}
JavaScript (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è script.js)
javascript

–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
// –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –±–µ–∑ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
const mockProducts = [
    {
        id: '1',
        name: 'iPhone 14 Pro Max 256GB Space Black',
        sellerSku: 'APL-IP14PM-256-SB',
        marketplace: 'Wildberries',
        category: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
        brand: 'Apple',
        subject: '–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã',
        sku: '123456789',
        barcode: '1234567890123',
        salePrice: 89990,
        costPrice: 75000, // –£–∫–∞–∑–∞–Ω–∞
        totalExpenses: 12500,
        marketplaceCommission: 4500,
        logistics: 890,
        acquiring: 900,
        returnsCost: 1200,
        utilization: 150,
        fines: 0,
        otherExpenses: 360,
        advertising: 4500,
        marginRub: 2490,
        marginPercent: 2.8,
        isProfitable: true
    },
    {
        id: '2',
        name: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏ Nike Air Max 270 –º—É–∂—Å–∫–∏–µ —á–µ—Ä–Ω—ã–µ 42',
        sellerSku: 'NK-AM270-BLK-42',
        marketplace: 'OZON',
        category: '–û–±—É–≤—å',
        brand: 'Nike',
        subject: '–ö—Ä–æ—Å—Å–æ–≤–∫–∏',
        sku: '987654321',
        barcode: '9876543210987',
        salePrice: 8990,
        costPrice: 4500, // –£–∫–∞–∑–∞–Ω–∞
        totalExpenses: 2890,
        marketplaceCommission: 1349,
        logistics: 450,
        acquiring: 90,
        returnsCost: 300,
        utilization: 50,
        fines: 200,
        otherExpenses: 150,
        advertising: 650,
        marginRub: 1600,
        marginPercent: 17.8,
        isProfitable: true
    },
    {
        id: '3',
        name: '–ü–ª–∞—Ç—å–µ –∂–µ–Ω—Å–∫–æ–µ –ª–µ—Ç–Ω–µ–µ —Å —Ü–≤–µ—Ç–æ—á–Ω—ã–º –ø—Ä–∏–Ω—Ç–æ–º —Ä–∞–∑–º–µ—Ä M',
        sellerSku: 'DR-FL-SUM-M-01',
        marketplace: 'Wildberries',
        category: '–û–¥–µ–∂–¥–∞',
        brand: 'NoName',
        subject: '–ü–ª–∞—Ç—å—è',
        sku: '456789123',
        barcode: '4567891234567',
        salePrice: 2990,
        costPrice: null, // –ù–ï –£–ö–ê–ó–ê–ù–ê
        totalExpenses: 1850,
        marketplaceCommission: 449,
        logistics: 280,
        acquiring: 30,
        returnsCost: 180,
        utilization: 20,
        fines: 50,
        otherExpenses: 90,
        advertising: 750,
        marginRub: null,
        marginPercent: null,
        isProfitable: null
    },
    {
        id: '4',
        name: '–ß–µ—Ö–æ–ª –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–∏–ª–∏–∫–æ–Ω–æ–≤—ã–π –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π iPhone 14',
        sellerSku: 'CS-SIL-TR-IP14',
        marketplace: 'OZON',
        category: '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã',
        brand: 'Generic',
        subject: '–ß–µ—Ö–ª—ã',
        sku: '789123456',
        barcode: '7891234567890',
        salePrice: 590,
        costPrice: null, // –ù–ï –£–ö–ê–ó–ê–ù–ê
        totalExpenses: 385,
        marketplaceCommission: 89,
        logistics: 95,
        acquiring: 6,
        returnsCost: 30,
        utilization: 5,
        otherExpenses: 15,
        advertising: 225,
        marginRub: null,
        marginPercent: null,
        isProfitable: null
    },
    {
        id: '5',
        name: '–ù–∞—É—à–Ω–∏–∫–∏ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ TWS —Å –∫–µ–π—Å–æ–º –∑–∞—Ä—è–¥–∫–∏',
        sellerSku: 'HP-TWS-WL-001',
        marketplace: 'Wildberries',
        category: '–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞',
        brand: 'TechBrand',
        subject: '–ù–∞—É—à–Ω–∏–∫–∏',
        sku: '321654987',
        barcode: '3216549876543',
        salePrice: 1490,
        costPrice: 650, // –£–∫–∞–∑–∞–Ω–∞
        totalExpenses: 1120,
        marketplaceCommission: 223,
        logistics: 180,
        acquiring: 15,
        returnsCost: 90,
        utilization: 10,
        otherExpenses: 25,
        advertising: 577,
        marginRub: -280,
        marginPercent: -18.8,
        isProfitable: false
    }
];

// –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª–∞—Å—Å ProductManager

// –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–æ–¥ updateStats –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
updateStats() {
    const profitable = this.filteredProducts.filter(p => p.isProfitable === true).length;
    const unprofitable = this.filteredProducts.filter(p => p.isProfitable === false).length;
    const needsCost = this.filteredProducts.filter(p => p.costPrice === null).length;
    const total = this.filteredProducts.length;

    document.getElementById('profitableCount').textContent = profitable;
    document.getElementById('unprofitableCount').textContent = unprofitable;
    document.getElementById('needsCostCount').textContent = needsCost;
    document.getElementById('totalCount').textContent = total;
}

// –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–æ–¥ renderProducts
renderProducts() {
    const container = document.getElementById('productsList');

    if (this.filteredProducts.length === 0) {
        container.innerHTML = `
            <div class="empty-state">
                <h3>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>
            </div>
        `;
        return;
    }

    container.innerHTML = this.filteredProducts.map(product => `
        <div class="product-card" data-product-id="${product.id}">
            <div class="card-content">
                <!-- –ò–∫–æ–Ω–∫–∞ —Ç–æ–≤–∞—Ä–∞ -->
                <div class="product-image">
                    ${this.getProductIcon(product.category)}
                </div>

                <!-- –ù–∞–∑–≤–∞–Ω–∏–µ + –ø–ª–æ—â–∞–¥–∫–∞ -->
                <div class="product-info">
                    <div class="product-title" title="${product.name}">
                        ${product.name}
                    </div>
                    <div class="product-marketplace">
                        ${this.getMarketplaceName(product.marketplace)}
                    </div>
                </div>

                <!-- –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ -->
                <div class="metric-column price">
                    <div class="metric-value">${this.formatCurrency(product.salePrice)}</div>
                    <div class="metric-label">–¶–µ–Ω–∞</div>
                </div>

                <!-- –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å -->
                <div class="metric-column cost-price-column">
                    <div class="metric-value ${product.costPrice === null ? 'editable not-specified' : 'editable'}" 
                         id="cost-${product.id}"
                         onclick="productManager.startEditCostPrice('${product.id}')">
                        ${product.costPrice === null ? 
                            '<span class="cost-value">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>' : 
                            `<span class="cost-value">${this.formatCurrency(product.costPrice)}</span>`}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </div>
                    <div class="metric-label">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</div>
                </div>

                <!-- –ú–∞—Ä–∂–∞ –≤ —Ä—É–±–ª—è—Ö -->
                <div class="metric-column margin-rub">
                    <div class="metric-value ${this.getMarginClass(product.marginRub)}" id="margin-rub-${product.id}">
                        ${product.marginRub === null ? '‚Äî' : this.formatCurrency(product.marginRub)}
                    </div>
                    <div class="metric-label">–ú–∞—Ä–∂–∞ ‚ÇΩ</div>
                </div>

                <!-- –ú–∞—Ä–∂–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö -->
                <div class="metric-column margin-percent">
                    <div class="metric-value ${this.getMarginClass(product.marginPercent)}" id="margin-percent-${product.id}">
                        ${product.marginPercent === null ? '‚Äî' : `${product.marginPercent.toFixed(1)}%`}
                    </div>
                    <div class="metric-label">–ú–∞—Ä–∂–∞ %</div>
                </div>

                <!-- –°—Ç–∞—Ç—É—Å –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ -->
                <div class="profitability-column">
                    <span class="profitability-badge ${this.getProfitabilityClass(product)}" id="status-${product.id}">
                        ${this.getProfitabilityText(product)}
                    </span>
                </div>

                <!-- –¢–∞–±—ã -->
                <div class="product-tabs">
                    <button class="tab-button" onclick="productManager.toggleTab('${product.id}', 'finances')">
                        <span class="tab-icon">üí∞</span>
                        <span class="tab-text">–§–∏–Ω–∞–Ω—Å—ã</span>
                        <div class="tooltip">–§–∏–Ω–∞–Ω—Å—ã</div>
                    </button>
                    <button class="tab-button" onclick="productManager.toggleTab('${product.id}', 'expenses')">
                        <span class="tab-icon">üìä</span>
                        <span class="tab-text">–†–∞—Å—Ö–æ–¥—ã</span>
                        <div class="tooltip">–†–∞—Å—Ö–æ–¥—ã</div>
                    </button>
                    <button class="tab-button" onclick="productManager.toggleTab('${product.id}', 'product')">
                        <span class="tab-icon">üì¶</span>
                        <span class="tab-text">–û —Ç–æ–≤–∞—Ä–µ</span>
                        <div class="tooltip">–û —Ç–æ–≤–∞—Ä–µ</div>
                    </button>
                </div>
            </div>

            ${this.renderTabsContent(product)}
        </div>
    `).join('');
}

// –ù–æ–≤—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
getMarginClass(margin) {
    if (margin === null) return 'undefined';
    return margin >= 0 ? 'positive' : 'negative';
}

getProfitabilityClass(product) {
    if (product.costPrice === null) return 'needs-cost';
    return product.isProfitable ? 'profitable' : 'unprofitable';
}

getProfitabilityText(product) {
    if (product.costPrice === null) return '–£–ö–ê–ñ–ò–¢–ï –°–ï–ë–ï–°–¢–û–ò–ú–û–°–¢–¨';
    return product.isProfitable ? '–ü–†–ò–ë–´–õ–¨–ù–´–ô' : '–£–ë–´–¢–û–ß–ù–´–ô';
}

// –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–æ–¥ recalculateProductMetrics
recalculateProductMetrics(product) {
    if (product.costPrice === null) {
        product.marginRub = null;
        product.marginPercent = null;
        product.isProfitable = null;
        return;
    }

    const totalCosts = product.costPrice + product.totalExpenses;
    product.marginRub = product.salePrice - totalCosts;
    product.marginPercent = product.salePrice > 0 ? (product.marginRub / product.salePrice) * 100 : 0;
    product.isProfitable = product.marginRub > 0;
}

// –û–±–Ω–æ–≤–ª—è–µ–º –º–µ—Ç–æ–¥ updateProductDisplay
updateProductDisplay(productId) {
    const product = this.products.find(p => p.id === productId);
    if (!product) return;

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
    const costElement = document.getElementById(`cost-${productId}`);
    if (costElement) {
        costElement.innerHTML = `
            <span class="cost-value">${product.costPrice === null ? '–ù–µ —É–∫–∞–∑–∞–Ω–æ' : this.formatCurrency(product.costPrice)}</span>
            <span class="edit-icon">‚úèÔ∏è</span>
        `;
        costElement.classList.remove('editing', 'not-specified');
        if (product.costPrice === null) {
            costElement.classList.add('not-specified');
        }
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ä–∂—É –≤ —Ä—É–±–ª—è—Ö
    const marginRubElement = document.getElementById(`margin-rub-${productId}`);
    if (marginRubElement) {
        marginRubElement.textContent = product.marginRub === null ? '‚Äî' : this.formatCurrency(product.marginRub);
        marginRubElement.className = `metric-value ${this.getMarginClass(product.marginRub)}`;
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ä–∂—É –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    const marginPercentElement = document.getElementById(`margin-percent-${productId}`);
    if (marginPercentElement)


